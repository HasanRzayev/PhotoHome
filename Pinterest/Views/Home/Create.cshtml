@model AddImageViewModel

<div class="container-fluid">
	<div class="col-xl-10 mx-auto" id="dragger_wrapper">
		<form method="post" asp-action="AddImage" asp-controller="Home" id="createImageForm" class="w-100 h-100 d-flex flex-row" enctype="multipart/form-data">
			@*<div class="col-xl-5 p-2">
			<div id="dragger">
			<div class="icon">
			<i class="fa-solid fa-images"></i>
			</div>
			<h3 id="drag-text">Drag and drop file</h3>
			<button class="py-1 px-3" id="browseFile" onclick="inputClick()">Browse</button>
			<input type="file" asp-for=ImageUrl hidden id="fileInputField" />
			</div>
			</div>*@
			<div class="col-xl-12 px-4">
				<div class="create-image">
					<div class="dropdown">
						<select asp-for=catagory_id asp-items=@ViewBag.Categories required></select><br />
					</div>
				</div>
				<div class="create-image">
					<input type="text" asp-for="Title" required />
				</div>
				<div class="create-image">
					<textarea asp-for="Description" id="textt" cols="30" rows="5"></textarea>
				</div>

				<div class="create-image">
					<div class="wrapper">
						<div class="content">
							<p>Press enter or add a comma after each tag</p>
							<ul id="tagUl">
								<input id="tagInput" type="text" spellcheck="false" required>
							</ul>
						</div>
						@*<div class="details">
						<p><span>10</span> tags are remaining</p>
						<button>Remove All</button>
						</div>*@
					</div>
				</div>

				<div class="create-image">
					<input type="file" asp-for="ImageUrl" placeholder="Select file" required>
				</div>
				<div class="col-xl-6 mx-auto">
					<input type="submit" onclick="sendData()" value="Create">
	
				</div>
			</div>
		</form>
	</div>
</div>

@section Scripts{

	<script>
		const ul = document.getElementById("tagUl"),
			input = document.getElementById("tagInput"),
			//tagNumb = document.querySelector(".details span");
		//let maxTags = 10,
			tags = ["coding", "nepal"];
		countTags();
		createTag();
		function countTags() {
			input.focus();
			//tagNumb.innerText = maxTags - tags.length;
		}
		function createTag() {
			ul.querySelectorAll("li").forEach(li => li.remove());
			tags.slice().reverse().forEach(tag => {
				let liTag = `<li>${tag} <i class="uit uit-multiply" onclick="remove(this, '${tag}')"></i></li>`;
				ul.insertAdjacentHTML("afterbegin", liTag);
			});
			countTags();
		}
		function remove(element, tag) {
			let index = tags.indexOf(tag);
			tags = [...tags.slice(0, index), ...tags.slice(index + 1)];
			element.parentElement.remove();
			countTags();
		}
		function addTag(e) {
			if (e.key == "Enter") {
				let tag = e.target.value.replace(/\s+/g, ' ');
				if (tag.length > 1 && !tags.includes(tag)) {
					if (tags.length < 10) {
						tag.split(',').forEach(tag => {
							tags.push(tag);
							createTag();
						});
					}
				}
				e.target.value = "";
			}
		}
		input.addEventListener("keyup", addTag);
		const removeBtn = document.querySelector(".details button");
		removeBtn.addEventListener("click", () => {
			tags.length = 0;
			ul.querySelectorAll("li").forEach(li => li.remove());
			countTags();
		});
	</script>

	@*	<script>
		$('form').keydown(function (event) {
				alert("a");
			if (event.key === 'Enter') {
				return false;
			}
		}
	</script>*@

	<script>
		$().ready(function () {
			$('.dropdown').click(function () {
				$(this).attr('tabindex', 1).focus();
				$(this).toggleClass('active');
				$(this).find('.dropdown-menu').slideToggle(200);
			});

			$('.dropdown').focusout(function () {
				$(this).removeClass('active');
				$(this).find('.dropdown-menu').slideUp(200);
			});

			$('.dropdown .dropdown-menu li').click(function () {
				$(this).parents('.dropdown').find('span').text($(this).text());
				$('.categoryName').val($(this).text());
				$(this).parents('.dropdown').find('input').attr('value', $(this).attr('id'));
			});
		})
	</script>
}